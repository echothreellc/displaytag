<?xml version="1.0" encoding="UTF-8" ?>
<project default="rebuild-all" xmlns:m="maven" xmlns:j="jelly:core" xmlns:u="jelly:util">

	<goal name="rebuild-all">
		<!-- Any ant task, or jelly tags can go here thanks to jeez -->
		<j:set var="goals" value="clean,jar:jar,war:war,cactus,site:generate" />
		<mkdir dir="${maven.build.dir}" />
		<u:tokenize var="goals" delim=",">${goals}</u:tokenize>
		<j:forEach items="${goals}" var="goal" indexVar="goalNumber">
			Now attaining goal number ${goalNumber}, which is ${goal}
			<attainGoal name="${goal}" />
		</j:forEach>
	</goal>

	<!-- preprocess faq.fml -->
	<preGoal name="xdoc:jelly-transform">
		<attainGoal name="faq" />
	</preGoal>

	<!-- add tld to taglib jar -->
	<postGoal name="java:jar-resources">
		<echo message="copying ${maven.src.dir}/tld/displaytag.tld to file ${maven.build.dest}/META-INF/displaytag.tld" />

		<copy file="${maven.src.dir}/tld/displaytag.tld" tofile="${maven.build.dest}/META-INF/displaytag.tld" />
	</postGoal>

	<!-- copy tld for example webapp -->
	<postGoal name="war:webapp">

		<echo message="deleting ${maven.war.webapp.dir}/META-INF" />
		<delete file="${maven.war.webapp.dir}/META-INF" />

		<echo message="copying ${maven.src.dir}/tld/displaytag.tld to dir ${maven.war.webapp.dir}/${maven.war.tld.dir}" />
		<copy file="${maven.src.dir}/tld/displaytag.tld" todir="${maven.war.webapp.dir}/${maven.war.tld.dir}" />

	</postGoal>

</project>
